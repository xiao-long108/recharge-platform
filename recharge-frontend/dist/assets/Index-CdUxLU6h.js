import{d as M,r as _,E as R,x as N,c as a,b as t,e as c,i as r,h as T,L as F,m as d,n as y,t as l,o,s as p,w as I,f as L,B as V,k as z}from"./index-4bcZGDoL.js";import{g,p as D}from"./request-C-LQhwRX.js";import{G as k}from"./GiftOutlined-DFMGQQuo.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";function G(){return g("/v1/coupons/available")}function O(u){return g("/v1/coupons/mine",{status:u})}function j(u){return D(`/v1/coupons/${u}/claim`)}const q={class:"page-container !pb-20"},H={class:"flex items-center bg-primary text-white p-4"},J={class:"flex bg-card p-1 m-3 rounded-lg"},K=["onClick"],P={key:0,class:"px-3"},Q={key:0,class:"empty-state"},S={key:1,class:"space-y-3"},U={class:"coupon-value"},W={class:"text-2xl font-bold"},X={class:"text-2xl font-bold"},Y={class:"text-xs opacity-80 mt-1"},Z={class:"coupon-right"},tt={class:"coupon-name"},st={class:"coupon-time"},et={key:1,class:"px-3"},at={key:0,class:"empty-state"},ot={class:"text-muted-foreground mt-3"},nt={key:1,class:"space-y-3"},lt={class:"coupon-value"},it={class:"text-2xl font-bold"},dt={class:"text-2xl font-bold"},ut={class:"text-xs opacity-80 mt-1"},ct={class:"coupon-right"},rt={class:"coupon-name"},pt={class:"coupon-time"},mt={key:0,class:"coupon-status text-primary"},vt={key:1,class:"coupon-status text-muted-foreground"},xt={key:2,class:"coupon-status text-muted-foreground"},_t=M({__name:"Index",setup(u){const h=T(),C=[{label:"领券中心",value:"available"},{label:"可使用",value:"unused"},{label:"已使用",value:"used"},{label:"已过期",value:"expired"}],i=_("available"),m=_([]),v=_([]),f=n=>n===1?"type-1":n===2?"type-2":"type-3",b=n=>n?n.slice(0,10):"",x=async()=>{try{m.value=await G()}catch{}},w=async n=>{try{v.value=await O(n)}catch{}},A=async n=>{try{await j(n.id),z.success("领取成功"),x()}catch{}};return R(i,n=>{n==="available"?x():w({unused:0,used:1,expired:2}[n])}),N(()=>{x()}),(n,e)=>{const $=V;return o(),a("div",q,[t("div",H,[c(r(F),{class:"text-xl cursor-pointer",onClick:e[0]||(e[0]=s=>r(h).back())}),e[1]||(e[1]=t("span",{class:"flex-1 text-center text-lg font-bold"},"优惠券",-1)),e[2]||(e[2]=t("span",{class:"w-5"},null,-1))]),t("div",J,[(o(),a(d,null,y(C,s=>t("div",{key:s.value,class:p(["flex-1 text-center py-3 rounded-md cursor-pointer text-sm transition-all",i.value===s.value?"bg-primary text-white":"text-foreground"]),onClick:B=>i.value=s.value},l(s.label),11,K)),64))]),i.value==="available"?(o(),a("div",P,[m.value.length===0?(o(),a("div",Q,[c(r(k),{class:"text-5xl text-muted-foreground"}),e[3]||(e[3]=t("p",{class:"text-muted-foreground mt-3"},"暂无可领取的优惠券",-1))])):(o(),a("div",S,[(o(!0),a(d,null,y(m.value,s=>(o(),a("div",{key:s.id,class:"coupon-card"},[t("div",{class:p(["coupon-left",f(s.type)])},[t("div",U,[s.type===2?(o(),a(d,{key:0},[t("span",W,l((s.discountRate/10).toFixed(1)),1),e[4]||(e[4]=t("span",{class:"text-sm"},"折",-1))],64)):(o(),a(d,{key:1},[e[5]||(e[5]=t("span",{class:"text-sm"},"R$",-1)),t("span",X,l(s.discountAmount),1)],64))]),t("div",Y,l(s.minAmount>0?`满${s.minAmount}可用`:"无门槛"),1)],2),t("div",Z,[t("div",tt,l(s.name),1),t("div",st,l(b(s.endTime))+" 到期",1),c($,{type:"primary",size:"small",class:"claim-btn",onClick:B=>A(s)},{default:I(()=>[...e[6]||(e[6]=[L(" 立即领取 ",-1)])]),_:1},8,["onClick"])])]))),128))]))])):(o(),a("div",et,[v.value.length===0?(o(),a("div",at,[c(r(k),{class:"text-5xl text-muted-foreground"}),t("p",ot,"暂无"+l(i.value==="unused"?"可用":i.value==="used"?"已使用的":"已过期的")+"优惠券",1)])):(o(),a("div",nt,[(o(!0),a(d,null,y(v.value,s=>(o(),a("div",{key:s.id,class:p(["coupon-card",{"opacity-60":i.value!=="unused"}])},[t("div",{class:p(["coupon-left",f(s.type)])},[t("div",lt,[s.type===2?(o(),a(d,{key:0},[t("span",it,l((s.discountRate/10).toFixed(1)),1),e[7]||(e[7]=t("span",{class:"text-sm"},"折",-1))],64)):(o(),a(d,{key:1},[e[8]||(e[8]=t("span",{class:"text-sm"},"R$",-1)),t("span",dt,l(s.discountAmount),1)],64))]),t("div",ut,l(s.minAmount>0?`满${s.minAmount}可用`:"无门槛"),1)],2),t("div",ct,[t("div",rt,l(s.couponName),1),t("div",pt,l(b(s.expireTime))+" 到期",1),i.value==="unused"?(o(),a("div",mt,"可使用")):i.value==="used"?(o(),a("div",vt,"已使用")):(o(),a("div",xt,"已过期"))])],2))),128))]))]))])}}}),gt=E(_t,[["__scopeId","data-v-81cf5ce0"]]);export{gt as default};
