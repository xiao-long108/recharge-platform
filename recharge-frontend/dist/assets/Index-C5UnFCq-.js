import{d as E,u as Z,r as u,D as N,x as q,c,b as t,e as l,i as d,h as G,L as H,s as b,t as i,z as h,I as J,R as K,w as k,B as Q,Z as X,M as Y,o as m,f as j,m as ee,n as te,p as se,$ as oe,j as ne,k as p}from"./index-4bcZGDoL.js";import{a as ae}from"./user-CwnAAeo_.js";import{a as le}from"./withdraw-CFb1cssN.js";import{C as re}from"./CreditCardOutlined-D1C0uqY8.js";import"./request-C-LQhwRX.js";const ue={class:"page-container !pb-24"},de={class:"flex items-center bg-primary text-white p-4"},ie={class:"user-card-gradient p-5"},me={class:"flex bg-white/10 rounded-lg p-1"},ce={class:"card-box m-3"},pe={class:"mb-5"},ve={class:"flex items-center border-b border-border pb-2"},xe={class:"mb-5"},fe={key:0,class:"text-sm"},be={key:1,class:"text-sm text-muted-foreground"},ge={key:0,class:"bg-muted p-3 rounded-lg"},ye={class:"flex justify-between text-sm py-1 text-muted-foreground"},_e={class:"flex justify-between text-sm py-1"},we={class:"text-destructive font-bold"},ke={class:"fixed bottom-0 left-0 right-0 p-4 bg-card shadow-[0_-2px_10px_rgba(0,0,0,0.05)]"},Ce=["onClick"],Be={class:"flex-1 ml-3"},Ne={class:"text-sm text-foreground"},he={class:"text-xs text-muted-foreground mt-1"},Ie={key:0,class:"text-center py-10 text-muted-foreground"},ze=E({__name:"Index",setup($e){const C=G(),g=Z(),r=u(1),a=u(""),v=u([]),o=u(null),y=u(!1),_=u(!1),x=u(""),B=u(!1),I=N(()=>(Number(a.value)||0)*.006),z=N(()=>(Number(a.value)||0)-I.value),D=N(()=>{const n=Number(a.value)||0;return n>=100&&n<=5e4&&o.value});q(async()=>{await V()});async function V(){try{v.value=await ae();const n=v.value.find(e=>e.isDefault===1);o.value=n||v.value[0]||null}catch{}}function L(n){o.value=n,y.value=!1}function M(){var w,f;const n=Number(a.value)||0;if(n<100)return p.error("提现金额不能少于100元");if(n>5e4)return p.error("提现金额不能超过50000元");const e=r.value===1?((w=g.userInfo)==null?void 0:w.balance)||0:((f=g.userInfo)==null?void 0:f.commissionBalance)||0;if(n>e)return p.error("余额不足");if(!o.value)return p.error("请选择银行卡");_.value=!0}async function P(){if(!x.value||x.value.length!==6)return p.error("请输入6位支付密码");if(o.value){B.value=!0;try{await le({bankAccountId:o.value.id,amount:Number(a.value),withdrawType:r.value,payPassword:x.value}),p.success("提现申请已提交"),_.value=!1,C.push("/withdraw/records")}catch{}finally{B.value=!1}}}return(n,e)=>{var $,A,S,F;const w=J,f=Q,R=X,T=ne,W=Y;return m(),c("div",ue,[t("div",de,[l(d(H),{class:"text-xl cursor-pointer",onClick:e[0]||(e[0]=s=>d(C).back())}),e[9]||(e[9]=t("span",{class:"flex-1 text-center text-lg font-bold"},"提现",-1)),e[10]||(e[10]=t("span",{class:"w-5"},null,-1))]),t("div",ie,[t("div",me,[t("div",{class:b(["flex-1 text-center py-4 rounded-md cursor-pointer",r.value===1?"bg-card text-primary":"text-white/80"]),onClick:e[1]||(e[1]=s=>r.value=1)},[t("div",{class:b(["text-2xl font-bold",r.value===1?"text-primary":"text-white"])}," ¥"+i(((A=($=d(g).userInfo)==null?void 0:$.balance)==null?void 0:A.toFixed(2))||"0.00"),3),e[11]||(e[11]=t("div",{class:"text-xs mt-1"},"余额",-1))],2),t("div",{class:b(["flex-1 text-center py-4 rounded-md cursor-pointer",r.value===2?"bg-card text-primary":"text-white/80"]),onClick:e[2]||(e[2]=s=>r.value=2)},[t("div",{class:b(["text-2xl font-bold",r.value===2?"text-primary":"text-white"])}," ¥"+i(((F=(S=d(g).userInfo)==null?void 0:S.commissionBalance)==null?void 0:F.toFixed(2))||"0.00"),3),e[12]||(e[12]=t("div",{class:"text-xs mt-1"},"佣金",-1))],2)])]),t("div",ce,[t("div",pe,[e[14]||(e[14]=t("div",{class:"text-sm text-foreground mb-2"},"提现金额",-1)),t("div",ve,[e[13]||(e[13]=t("span",{class:"text-2xl text-foreground mr-2"},"¥",-1)),l(w,{value:a.value,"onUpdate:value":e[3]||(e[3]=s=>a.value=s),type:"number",placeholder:"请输入提现金额",bordered:!1,class:"!text-2xl"},null,8,["value"])]),e[15]||(e[15]=t("div",{class:"text-xs text-muted-foreground mt-2"},"提现手续费：0.6%，最低100元，最高50000元",-1))]),t("div",xe,[e[16]||(e[16]=t("div",{class:"text-sm text-foreground mb-2"},"提现到",-1)),t("div",{class:"flex items-center justify-between bg-muted p-3 rounded-lg cursor-pointer",onClick:e[4]||(e[4]=s=>y.value=!0)},[o.value?(m(),c("span",fe,i(o.value.bankName)+" ("+i(o.value.accountNumber.slice(-4))+")",1)):(m(),c("span",be,"请选择银行卡")),l(d(K),{class:"text-muted-foreground"})])]),a.value&&Number(a.value)>0?(m(),c("div",ge,[t("div",ye,[e[17]||(e[17]=t("span",null,"手续费",-1)),t("span",null,"¥"+i(I.value.toFixed(2)),1)]),t("div",_e,[e[18]||(e[18]=t("span",{class:"text-muted-foreground"},"实际到账",-1)),t("span",we,"¥"+i(z.value.toFixed(2)),1)])])):h("",!0)]),t("div",ke,[l(f,{type:"primary",size:"large",class:"w-full h-12",disabled:!D.value,onClick:M},{default:k(()=>[...e[19]||(e[19]=[j(" 确认提现 ",-1)])]),_:1},8,["disabled"])]),l(R,{open:y.value,"onUpdate:open":e[6]||(e[6]=s=>y.value=s),title:"选择银行卡",placement:"bottom",height:"50%"},{default:k(()=>[(m(!0),c(ee,null,te(v.value,s=>{var O,U;return m(),c("div",{key:s.id,class:b(["flex items-center p-4 border-b border-border cursor-pointer",((O=o.value)==null?void 0:O.id)===s.id?"bg-primary/5":""]),onClick:Ae=>L(s)},[l(d(re),{class:"text-2xl text-primary"}),t("div",Be,[t("div",Ne,i(s.bankName),1),t("div",he,"**** "+i(s.accountNumber.slice(-4)),1)]),((U=o.value)==null?void 0:U.id)===s.id?(m(),se(d(oe),{key:0,class:"text-success"})):h("",!0)],10,Ce)}),128)),v.value.length===0?(m(),c("div",Ie,[e[21]||(e[21]=t("p",{class:"mb-4"},"暂无银行卡",-1)),l(f,{type:"primary",onClick:e[5]||(e[5]=s=>d(C).push("/bank-account/add"))},{default:k(()=>[...e[20]||(e[20]=[j("添加银行卡",-1)])]),_:1})])):h("",!0)]),_:1},8,["open"]),l(W,{open:_.value,"onUpdate:open":e[8]||(e[8]=s=>_.value=s),title:"输入支付密码","confirm-loading":B.value,onOk:P},{default:k(()=>[l(T,{value:x.value,"onUpdate:value":e[7]||(e[7]=s=>x.value=s),placeholder:"请输入6位支付密码",maxlength:6,size:"large",class:"mt-4"},null,8,["value"])]),_:1},8,["open","confirm-loading"])])}}});export{ze as default};
