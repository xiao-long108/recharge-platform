import{g as M,p as $,a as E}from"./request-C-LQhwRX.js";import{e as o,l as V,d as T,u as A,r as x,a as C,D as G,E as q,x as H,c as g,m as J,b as a,t as v,w as i,B as Q,i as h,M as R,o as y,f as b,F as W,_ as X,I as Y,G as Z,j as K,k as c}from"./index-4bcZGDoL.js";import{S as ee}from"./ShopOutlined-CUHiM7D0.js";var te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"}}]},name:"link",theme:"outlined"};function j(n){for(var l=1;l<arguments.length;l++){var t=arguments[l]!=null?Object(arguments[l]):{},r=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable}))),r.forEach(function(d){oe(n,d,t[d])})}return n}function oe(n,l,t){return l in n?Object.defineProperty(n,l,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[l]=t,n}var w=function(l,t){var r=j({},l,t.attrs);return o(V,j({},r,{icon:te}),null)};w.displayName="LinkOutlined";w.inheritAttrs=!1;function ae(){return M("/v1/store/my")}function se(n){return $("/v1/store/open",n)}function ne(n){return E("/v1/store/update",n)}const le={class:"page-container !pb-20"},re={class:"user-card-gradient p-8 text-white flex justify-between items-start"},ie={class:"text-2xl font-bold"},ue={class:"text-sm opacity-90 mt-2"},de={class:"card-box m-3 flex"},pe={class:"flex-1 text-center"},ce={class:"text-2xl font-bold text-primary"},me={class:"flex-1 text-center"},fe={class:"text-2xl font-bold text-primary"},ve={class:"card-box m-3"},xe={class:"text-center"},_e={class:"bg-muted p-5 rounded-lg mb-4"},ge={class:"text-xs text-muted-foreground mt-2 break-all"},ye={key:1,class:"text-center py-24 px-5"},ke=T({__name:"Index",setup(n){const l=A(),t=x(null),r=x(!1),d=x(!1),m=x(!1),u=C({storeName:"",storeDescription:"",payPassword:""}),p=C({storeName:"",storeDescription:""}),O=G(()=>!t.value||!l.userInfo?"":`${window.location.origin}/register?inviteCode=${l.userInfo.inviteCode}`);q(m,N=>{N&&t.value&&(p.storeName=t.value.storeName,p.storeDescription=t.value.storeDescription||"")}),H(async()=>{await k()});async function k(){try{t.value=await ae()}catch{t.value=null}}async function z(){if(!u.storeName)return c.error("请输入店铺名称");if(!u.payPassword)return c.error("请输入支付密码");r.value=!0;try{t.value=await se(u),c.success("开通成功"),d.value=!1}catch{}finally{r.value=!1}}async function B(){if(!p.storeName)return c.error("请输入店铺名称");r.value=!0;try{await ne(p),c.success("保存成功"),m.value=!1,await k()}catch{}finally{r.value=!1}}function F(){navigator.clipboard.writeText(O.value),c.success("链接已复制")}return(N,e)=>{var U;const _=Q,S=Y,f=X,D=Z,I=K,L=W,P=R;return y(),g("div",le,[t.value?(y(),g(J,{key:0},[a("div",re,[a("div",null,[a("div",ie,v(t.value.storeName),1),a("div",ue,v(t.value.storeDescription||"暂无描述"),1)]),o(_,{size:"small",onClick:e[0]||(e[0]=s=>m.value=!0)},{default:i(()=>[...e[9]||(e[9]=[b("编辑",-1)])]),_:1})]),a("div",de,[a("div",pe,[a("div",ce,v(t.value.totalOrders),1),e[10]||(e[10]=a("div",{class:"text-xs text-muted-foreground mt-1"},"总订单",-1))]),a("div",me,[a("div",fe,"¥"+v(((U=t.value.totalSales)==null?void 0:U.toFixed(2))||"0.00"),1),e[11]||(e[11]=a("div",{class:"text-xs text-muted-foreground mt-1"},"总销售额",-1))])]),a("div",ve,[e[13]||(e[13]=a("div",{class:"text-base font-bold text-foreground mb-4"},"店铺二维码",-1)),a("div",xe,[a("div",_e,[o(h(w),{class:"text-3xl text-primary"}),a("p",ge,v(O.value),1)]),o(_,{type:"primary",size:"small",onClick:F},{default:i(()=>[...e[12]||(e[12]=[b("复制链接",-1)])]),_:1})])])],64)):(y(),g("div",ye,[o(h(ee),{class:"text-6xl text-muted-foreground"}),e[15]||(e[15]=a("p",{class:"text-base text-foreground mt-4"},"您还没有开通店铺",-1)),e[16]||(e[16]=a("p",{class:"text-sm text-muted-foreground mt-2"},"开通店铺后，可以推广充值服务赚取佣金",-1)),o(_,{type:"primary",size:"large",class:"mt-6 w-48 h-11",onClick:e[1]||(e[1]=s=>d.value=!0)},{default:i(()=>[...e[14]||(e[14]=[b("立即开通",-1)])]),_:1})])),o(P,{open:d.value,"onUpdate:open":e[5]||(e[5]=s=>d.value=s),title:"开通店铺","confirm-loading":r.value,onOk:z},{default:i(()=>[o(L,{model:u,layout:"vertical",class:"mt-4"},{default:i(()=>[o(f,{label:"店铺名称"},{default:i(()=>[o(S,{value:u.storeName,"onUpdate:value":e[2]||(e[2]=s=>u.storeName=s),placeholder:"请输入店铺名称"},null,8,["value"])]),_:1}),o(f,{label:"店铺描述"},{default:i(()=>[o(D,{value:u.storeDescription,"onUpdate:value":e[3]||(e[3]=s=>u.storeDescription=s),placeholder:"请输入店铺描述",rows:3},null,8,["value"])]),_:1}),o(f,{label:"支付密码"},{default:i(()=>[o(I,{value:u.payPassword,"onUpdate:value":e[4]||(e[4]=s=>u.payPassword=s),maxlength:6,placeholder:"请输入支付密码"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","confirm-loading"]),o(P,{open:m.value,"onUpdate:open":e[8]||(e[8]=s=>m.value=s),title:"编辑店铺","confirm-loading":r.value,onOk:B},{default:i(()=>[o(L,{model:p,layout:"vertical",class:"mt-4"},{default:i(()=>[o(f,{label:"店铺名称"},{default:i(()=>[o(S,{value:p.storeName,"onUpdate:value":e[6]||(e[6]=s=>p.storeName=s),placeholder:"请输入店铺名称"},null,8,["value"])]),_:1}),o(f,{label:"店铺描述"},{default:i(()=>[o(D,{value:p.storeDescription,"onUpdate:value":e[7]||(e[7]=s=>p.storeDescription=s),placeholder:"请输入店铺描述",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","confirm-loading"])])}}});export{ke as default};
