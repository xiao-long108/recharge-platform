import{r as I}from"./request-npLowYHc.js";import{d as nt,r as p,a as R,E as ot,c as W,b as n,e,h as i,y as l,w as a,I as lt,R as it,U as ut,B as dt,W as rt,a7 as ct,O as M,f,Q as Y,T as pt,V as _t,a8 as mt,A as vt,a0 as ft,p as A,ae as gt,af as wt,ag as bt,Y as kt,X as q,$ as yt,F as ht,_ as xt,a6 as Ct,i as b,a1 as $t,o as C,j as St}from"./index-Djgp8zeB.js";import{U as It}from"./UploadOutlined-BLOLIyP5.js";const Nt={class:"withdraws-page"},Ut={class:"stats-cards"},zt={class:"stat-card"},Dt={class:"stat-value orange"},Rt={class:"stat-card"},At={class:"stat-value blue"},jt={class:"stat-card"},Ot={class:"stat-value green"},Vt={class:"stat-card"},Tt={class:"stat-value green"},Bt={class:"filter-bar"},Ft={class:"filter-left"},Wt={class:"filter-right"},Mt={class:"table-container"},Yt={class:"order-no"},qt={class:"user-info"},Et={class:"user-detail"},Lt={class:"nickname"},Qt={class:"user-id"},Pt={class:"amount"},Xt={class:"bank-info"},Gt={class:"bank-name"},Ht={class:"account-no"},Jt={class:"pagination-container"},Kt={class:"total-text"},Zt={class:"amount"},te={class:"reject-reason"},ee={class:"amount"},ae="https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",se=nt({__name:"Withdraws",setup(ne){const N=p(!1),j=p([]),U=p(0),g=p([]),$=p(!1),u=p(null),k=R({pendingCount:0,todayAmount:0,monthAmount:0,totalAmount:0}),d=R({pageNum:1,pageSize:10,userId:"",status:null}),_=o=>o?o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00",O=o=>({1:"成功",2:"失败",3:"待审核"})[o]||"未知",V=o=>({1:"success",2:"error",3:"warning"})[o]||"default",z=async()=>{try{const o=await I.get("/api/admin/withdraws/stats");o.data.code===200&&Object.assign(k,o.data.data)}catch(o){console.error("获取提现统计失败",o)}},m=async()=>{var o;N.value=!0;try{const t={...d};((o=g.value)==null?void 0:o.length)===2&&(t.startDate=g.value[0],t.endDate=g.value[1]);const h=await I.get("/api/admin/withdraws",{params:t});h.data.code===200&&(j.value=h.data.data.records,U.value=h.data.data.total)}catch(t){console.error(t)}finally{N.value=!1}},E=()=>{d.userId="",d.status=null,d.pageNum=1,g.value=[],m()},L=o=>{u.value=o,$.value=!0},Q=()=>{b.info("导出功能开发中")},P=async o=>{M.confirm({title:"审核通过",content:`确定要通过该提现申请吗？金额：R$ ${_(o.price)}`,okText:"确认通过",onOk:async()=>{try{await I.post(`/api/admin/withdraws/${o.id}/approve`),b.success("审核通过"),m(),z()}catch{b.error("操作失败")}}})},y=p(!1),D=p(null),w=R({reason:""}),X=o=>{D.value=o,w.reason="",y.value=!0},G=async()=>{if(!w.reason.trim()){b.warning("请输入拒绝原因");return}try{await I.post(`/api/admin/withdraws/${D.value.id}/reject`,w),b.success("已拒绝该提现申请"),y.value=!1,m(),z()}catch{b.error("操作失败")}};return ot(()=>{z(),m()}),(o,t)=>{const h=lt,S=pt,H=it,J=ut,r=dt,v=mt,K=vt,T=ft,Z=rt,tt=ct,c=yt,et=$t,B=M,F=xt,at=Ct,st=ht;return C(),W("div",Nt,[n("div",Ut,[n("div",zt,[t[11]||(t[11]=n("div",{class:"stat-label"},"待审核",-1)),n("div",Dt,[i(l(k.pendingCount)+" ",1),t[10]||(t[10]=n("span",{class:"unit"},"笔",-1))])]),n("div",Rt,[t[12]||(t[12]=n("div",{class:"stat-label"},"今日提现",-1)),n("div",At,"R$ "+l(_(k.todayAmount)),1)]),n("div",jt,[t[13]||(t[13]=n("div",{class:"stat-label"},"本月提现",-1)),n("div",Ot,"R$ "+l(_(k.monthAmount)),1)]),n("div",Vt,[t[14]||(t[14]=n("div",{class:"stat-label"},"累计提现",-1)),n("div",Tt,"R$ "+l(_(k.totalAmount)),1)])]),n("div",Bt,[n("div",Ft,[e(h,{value:d.userId,"onUpdate:value":t[0]||(t[0]=s=>d.userId=s),placeholder:"用户ID","allow-clear":"",style:{width:"150px"}},{prefix:a(()=>[e(f(Y))]),_:1},8,["value"]),e(H,{value:d.status,"onUpdate:value":t[1]||(t[1]=s=>d.status=s),placeholder:"提现状态","allow-clear":"",style:{width:"140px"}},{default:a(()=>[e(S,{value:null},{default:a(()=>[...t[15]||(t[15]=[i("全部",-1)])]),_:1}),e(S,{value:3},{default:a(()=>[...t[16]||(t[16]=[i("待审核",-1)])]),_:1}),e(S,{value:1},{default:a(()=>[...t[17]||(t[17]=[i("成功",-1)])]),_:1}),e(S,{value:2},{default:a(()=>[...t[18]||(t[18]=[i("失败",-1)])]),_:1})]),_:1},8,["value"]),e(J,{value:g.value,"onUpdate:value":t[2]||(t[2]=s=>g.value=s),"value-format":"YYYY-MM-DD",style:{width:"260px"}},null,8,["value"])]),n("div",Wt,[e(r,{type:"primary",onClick:m},{icon:a(()=>[e(f(Y))]),default:a(()=>[t[19]||(t[19]=i(" 查询 ",-1))]),_:1}),e(r,{onClick:E},{icon:a(()=>[e(f(_t))]),default:a(()=>[t[20]||(t[20]=i(" 重置 ",-1))]),_:1}),e(r,{onClick:Q},{icon:a(()=>[e(f(It))]),default:a(()=>[t[21]||(t[21]=i(" 导出 ",-1))]),_:1})])]),n("div",Mt,[e(Z,{"data-source":j.value,loading:N.value,pagination:!1,scroll:{x:1200}},{default:a(()=>[e(v,{title:"提现单号",width:160},{default:a(({record:s})=>[n("div",Yt,"W"+l(s.id),1)]),_:1}),e(v,{title:"用户信息",width:180},{default:a(({record:s})=>[n("div",qt,[e(K,{size:36,src:s.userAvatar||ae},{default:a(()=>{var x;return[i(l(((x=s.userNickname)==null?void 0:x.charAt(0))||"U"),1)]}),_:2},1032,["src"]),n("div",Et,[n("div",Lt,l(s.userNickname||"用户"+s.userId),1),n("div",Qt,"ID: "+l(s.userId),1)])])]),_:1}),e(v,{title:"提现金额","data-index":"price",width:140,align:"right"},{default:a(({record:s})=>[n("span",Pt,"R$ "+l(_(s.price)),1)]),_:1}),e(v,{title:"银行账户",width:180},{default:a(({record:s})=>[n("div",Xt,[n("div",Gt,l(s.bankName||"-"),1),n("div",Ht,l(s.accountNumber||"-"),1)])]),_:1}),e(v,{title:"状态","data-index":"status",width:100,align:"center"},{default:a(({record:s})=>[e(T,{color:V(s.status)},{default:a(()=>[i(l(O(s.status)),1)]),_:2},1032,["color"])]),_:1}),e(v,{title:"申请时间","data-index":"createTime",width:160,align:"center"}),e(v,{title:"操作",width:140,align:"center",fixed:"right"},{default:a(({record:s})=>[s.status===3?(C(),W(gt,{key:0},[e(r,{type:"link",size:"small",onClick:x=>P(s)},{default:a(()=>[e(f(wt)),t[22]||(t[22]=i(" 通过 ",-1))]),_:1},8,["onClick"]),e(r,{type:"link",danger:"",size:"small",onClick:x=>X(s)},{default:a(()=>[e(f(bt)),t[23]||(t[23]=i(" 拒绝 ",-1))]),_:1},8,["onClick"])],64)):(C(),A(r,{key:1,type:"link",size:"small",onClick:x=>L(s)},{default:a(()=>[e(f(kt))]),_:1},8,["onClick"]))]),_:1})]),_:1},8,["data-source","loading"])]),n("div",Jt,[n("span",Kt,"共 "+l(U.value)+" 条记录",1),e(tt,{current:d.pageNum,"onUpdate:current":t[3]||(t[3]=s=>d.pageNum=s),"page-size":d.pageSize,"onUpdate:pageSize":t[4]||(t[4]=s=>d.pageSize=s),total:U.value,"show-size-changer":!0,"page-size-options":["10","20","50","100"],"show-quick-jumper":"",onChange:m,onShowSizeChange:m},null,8,["current","page-size","total"])]),e(B,{open:$.value,"onUpdate:open":t[6]||(t[6]=s=>$.value=s),title:"提现详情",width:"550px"},{footer:a(()=>[e(r,{onClick:t[5]||(t[5]=s=>$.value=!1)},{default:a(()=>[...t[24]||(t[24]=[i("关闭",-1)])]),_:1})]),default:a(()=>[u.value?(C(),A(et,{key:0,column:2,bordered:""},{default:a(()=>[e(c,{label:"提现单号"},{default:a(()=>[i("W"+l(u.value.id),1)]),_:1}),e(c,{label:"用户ID"},{default:a(()=>[i(l(u.value.userId),1)]),_:1}),e(c,{label:"提现金额"},{default:a(()=>[n("span",Zt,"R$ "+l(_(u.value.price)),1)]),_:1}),e(c,{label:"提现状态"},{default:a(()=>[e(T,{color:V(u.value.status)},{default:a(()=>[i(l(O(u.value.status)),1)]),_:1},8,["color"])]),_:1}),e(c,{label:"银行名称"},{default:a(()=>[i(l(u.value.bankName||"-"),1)]),_:1}),e(c,{label:"账户号码"},{default:a(()=>[i(l(u.value.accountNumber||"-"),1)]),_:1}),e(c,{label:"申请时间",span:2},{default:a(()=>[i(l(u.value.createTime),1)]),_:1}),u.value.reason?(C(),A(c,{key:0,label:"拒绝原因",span:2},{default:a(()=>[n("span",te,l(u.value.reason),1)]),_:1})):q("",!0)]),_:1})):q("",!0)]),_:1},8,["open"]),e(B,{open:y.value,"onUpdate:open":t[9]||(t[9]=s=>y.value=s),title:"拒绝提现",width:"450px"},{footer:a(()=>[e(r,{onClick:t[8]||(t[8]=s=>y.value=!1)},{default:a(()=>[...t[25]||(t[25]=[i("取消",-1)])]),_:1}),e(r,{danger:"",onClick:G},{default:a(()=>[...t[26]||(t[26]=[i("确认拒绝",-1)])]),_:1})]),default:a(()=>[e(st,{model:w,"label-col":{span:6},"wrapper-col":{span:18}},{default:a(()=>[e(F,{label:"提现金额"},{default:a(()=>{var s;return[n("span",ee,"R$ "+l(_((s=D.value)==null?void 0:s.price)),1)]}),_:1}),e(F,{label:"拒绝原因",required:""},{default:a(()=>[e(at,{value:w.reason,"onUpdate:value":t[7]||(t[7]=s=>w.reason=s),rows:3,placeholder:"请输入拒绝原因，将反馈给用户"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])])}}}),ue=St(se,[["__scopeId","data-v-02adffba"]]);export{ue as default};
