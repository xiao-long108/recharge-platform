import{r as $}from"./request-npLowYHc.js";import{d as Y,r as y,a as q,E as G,c as H,b as e,e as s,h as n,y as i,w as a,I as J,R as K,B as Z,W as tt,a7 as st,O as I,f as b,Q as A,T as at,V as et,a8 as lt,A as nt,a0 as ot,p as D,X as T,Y as it,$ as ut,i as w,a1 as dt,o as O,j as rt}from"./index-Djgp8zeB.js";import{S as pt}from"./ShopOutlined-BO2HQ33Q.js";const ct={class:"stores-page"},vt={class:"stats-cards"},_t={class:"stat-card"},ft={class:"stat-value blue"},mt={class:"stat-card"},gt={class:"stat-value green"},St={class:"stat-card"},yt={class:"stat-value gray"},bt={class:"stat-card"},kt={class:"stat-value orange"},$t={class:"stat-card"},wt={class:"stat-value red"},Ot={class:"stat-card"},xt={class:"stat-value green"},Ct={class:"filter-bar"},zt={class:"filter-left"},Nt={class:"filter-right"},It={class:"table-container"},Dt={class:"store-info"},Tt={class:"store-detail"},Ut={class:"name"},Vt={class:"desc"},Bt={class:"font-medium"},jt={class:"pagination-container"},Rt={class:"total-text"},ht={class:"font-medium"},qt={class:"mt-4 flex justify-end gap-2"},At=Y({__name:"Stores",setup(Et){const x=y(!1),U=y([]),C=y(0),m=y(!1),u=y(null),r=q({total:0,open:0,closed:0,pending:0,approved:0,frozen:0,rejected:0,monthSales:0}),d=q({pageNum:1,pageSize:10,storeName:"",status:null,openStatus:null}),V=o=>{switch(o){case 0:return"warning";case 1:return"success";case 2:return"error";case 3:return"default";default:return"default"}},B=o=>{switch(o){case 0:return"待审核";case 1:return"审核通过";case 2:return"已冻结";case 3:return"已拒绝";default:return"未知"}},z=o=>o?o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00",N=async()=>{try{const o=await $.get("/api/admin/stores/stats");o.data.code===200&&Object.assign(r,o.data.data)}catch{r.total=256,r.normal=248,r.frozen=8,r.monthSales=1568e3}},g=async()=>{x.value=!0;try{const o=await $.get("/api/admin/stores",{params:d});o.data.code===200&&(U.value=o.data.data.records,C.value=o.data.data.total)}catch(o){console.error(o)}finally{x.value=!1}},E=()=>{d.storeName="",d.status=null,d.openStatus=null,d.pageNum=1,g()},L=o=>{u.value=o,m.value=!0},j=o=>{const t=o.sOpenStatus===1?"关闭":"开通";I.confirm({title:`确认${t}`,content:`确定要${t}该店铺吗？${o.sOpenStatus===1?"关闭后店铺将无法正常营业":""}`,onOk:async()=>{try{await $.put(`/api/admin/stores/${o.id}/open-status`,{status:o.sOpenStatus===1?2:1}),w.success(`${t}成功`),m.value=!1,g(),N()}catch{w.error(`${t}失败`)}}})},R=o=>{const t=o.sStatus===1?"冻结":"解冻";I.confirm({title:`确认${t}`,content:`确定要${t}该店铺吗？${o.sStatus===1?"冻结后店铺将无法正常营业":""}`,onOk:async()=>{try{await $.put(`/api/admin/stores/${o.id}/status`,{status:o.sStatus===1?2:1}),w.success(`${t}成功`),m.value=!1,g(),N()}catch{w.error(`${t}失败`)}}})};return G(()=>{N(),g()}),(o,t)=>{const M=J,c=at,h=K,v=Z,F=nt,f=lt,k=ot,P=tt,Q=st,p=ut,W=dt,X=I;return O(),H("div",ct,[e("div",vt,[e("div",_t,[t[10]||(t[10]=e("div",{class:"stat-label"},"店铺总数",-1)),e("div",ft,[n(i(r.total)+" ",1),t[9]||(t[9]=e("span",{class:"unit"},"家",-1))])]),e("div",mt,[t[12]||(t[12]=e("div",{class:"stat-label"},"正常开通",-1)),e("div",gt,[n(i(r.open)+" ",1),t[11]||(t[11]=e("span",{class:"unit"},"家",-1))])]),e("div",St,[t[14]||(t[14]=e("div",{class:"stat-label"},"已关闭",-1)),e("div",yt,[n(i(r.closed)+" ",1),t[13]||(t[13]=e("span",{class:"unit"},"家",-1))])]),e("div",bt,[t[16]||(t[16]=e("div",{class:"stat-label"},"待审核",-1)),e("div",kt,[n(i(r.pending)+" ",1),t[15]||(t[15]=e("span",{class:"unit"},"家",-1))])]),e("div",$t,[t[18]||(t[18]=e("div",{class:"stat-label"},"已冻结",-1)),e("div",wt,[n(i(r.frozen)+" ",1),t[17]||(t[17]=e("span",{class:"unit"},"家",-1))])]),e("div",Ot,[t[19]||(t[19]=e("div",{class:"stat-label"},"本月销售",-1)),e("div",xt,"R$ "+i(z(r.monthSales)),1)])]),e("div",Ct,[e("div",zt,[s(M,{value:d.storeName,"onUpdate:value":t[0]||(t[0]=l=>d.storeName=l),placeholder:"店铺名称/ID","allow-clear":"",style:{width:"180px"}},{prefix:a(()=>[s(b(A))]),_:1},8,["value"]),s(h,{value:d.openStatus,"onUpdate:value":t[1]||(t[1]=l=>d.openStatus=l),placeholder:"开通状态","allow-clear":"",style:{width:"120px"}},{default:a(()=>[s(c,{value:null},{default:a(()=>[...t[20]||(t[20]=[n("全部",-1)])]),_:1}),s(c,{value:1},{default:a(()=>[...t[21]||(t[21]=[n("正常开通",-1)])]),_:1}),s(c,{value:2},{default:a(()=>[...t[22]||(t[22]=[n("已关闭",-1)])]),_:1})]),_:1},8,["value"]),s(h,{value:d.status,"onUpdate:value":t[2]||(t[2]=l=>d.status=l),placeholder:"审核状态","allow-clear":"",style:{width:"120px"}},{default:a(()=>[s(c,{value:null},{default:a(()=>[...t[23]||(t[23]=[n("全部",-1)])]),_:1}),s(c,{value:0},{default:a(()=>[...t[24]||(t[24]=[n("待审核",-1)])]),_:1}),s(c,{value:1},{default:a(()=>[...t[25]||(t[25]=[n("审核通过",-1)])]),_:1}),s(c,{value:2},{default:a(()=>[...t[26]||(t[26]=[n("已冻结",-1)])]),_:1}),s(c,{value:3},{default:a(()=>[...t[27]||(t[27]=[n("已拒绝",-1)])]),_:1})]),_:1},8,["value"])]),e("div",Nt,[s(v,{type:"primary",onClick:g},{icon:a(()=>[s(b(A))]),default:a(()=>[t[28]||(t[28]=n(" 查询 ",-1))]),_:1}),s(v,{onClick:E},{icon:a(()=>[s(b(et))]),default:a(()=>[t[29]||(t[29]=n(" 重置 ",-1))]),_:1})])]),e("div",It,[s(P,{"data-source":U.value,loading:x.value,pagination:!1,scroll:{x:1100}},{default:a(()=>[s(f,{title:"店铺信息",width:260},{default:a(({record:l})=>[e("div",Dt,[s(F,{size:44,src:l.sLogo,shape:"square"},{icon:a(()=>[s(b(pt))]),_:1},8,["src"]),e("div",Tt,[e("div",Ut,i(l.sName),1),e("div",Vt,"ID: "+i(l.id)+" | 店主: 用户"+i(l.userId),1)])])]),_:1}),s(f,{title:"销量",width:100,align:"center"},{default:a(({record:l})=>[e("span",null,i(l.sSales||0),1)]),_:1}),s(f,{title:"店铺余额",width:140,align:"right"},{default:a(({record:l})=>[e("span",Bt,"R$ "+i(z(l.sPrice)),1)]),_:1}),s(f,{title:"开通状态",width:100,align:"center"},{default:a(({record:l})=>[s(k,{color:l.sOpenStatus===1?"success":"default"},{default:a(()=>[n(i(l.sOpenStatus===1?"正常开通":"已关闭"),1)]),_:2},1032,["color"])]),_:1}),s(f,{title:"审核状态",width:100,align:"center"},{default:a(({record:l})=>[s(k,{color:V(l.sStatus)},{default:a(()=>[n(i(B(l.sStatus)),1)]),_:2},1032,["color"])]),_:1}),s(f,{title:"开店时间","data-index":"createTime",width:160,align:"center"}),s(f,{title:"操作",width:220,align:"center",fixed:"right"},{default:a(({record:l})=>[s(v,{type:"link",size:"small",onClick:S=>L(l)},{default:a(()=>[s(b(it)),t[30]||(t[30]=n(" 详情 ",-1))]),_:1},8,["onClick"]),s(v,{type:"link",size:"small",onClick:S=>j(l)},{default:a(()=>[n(i(l.sOpenStatus===1?"关闭":"开通"),1)]),_:2},1032,["onClick"]),l.sStatus===1||l.sStatus===2?(O(),D(v,{key:0,type:"link",size:"small",onClick:S=>R(l)},{default:a(()=>[n(i(l.sStatus===1?"冻结":"解冻"),1)]),_:2},1032,["onClick"])):T("",!0)]),_:1})]),_:1},8,["data-source","loading"])]),e("div",jt,[e("span",Rt,"共 "+i(C.value)+" 条记录",1),s(Q,{current:d.pageNum,"onUpdate:current":t[3]||(t[3]=l=>d.pageNum=l),"page-size":d.pageSize,"onUpdate:pageSize":t[4]||(t[4]=l=>d.pageSize=l),total:C.value,"show-size-changer":!0,"show-quick-jumper":"",onChange:g},null,8,["current","page-size","total"])]),s(X,{open:m.value,"onUpdate:open":t[8]||(t[8]=l=>m.value=l),title:"店铺详情",width:"650px",footer:null},{default:a(()=>{var l,S;return[u.value?(O(),D(W,{key:0,column:2,bordered:"",class:"mt-4"},{default:a(()=>[s(p,{label:"店铺ID"},{default:a(()=>[n(i(u.value.id),1)]),_:1}),s(p,{label:"店主ID"},{default:a(()=>[n(i(u.value.userId),1)]),_:1}),s(p,{label:"店铺名称",span:2},{default:a(()=>[n(i(u.value.sName),1)]),_:1}),s(p,{label:"店铺描述",span:2},{default:a(()=>[n(i(u.value.sInfo||"暂无描述"),1)]),_:1}),s(p,{label:"销量"},{default:a(()=>[n(i(u.value.sSales||0)+" 笔",1)]),_:1}),s(p,{label:"店铺余额"},{default:a(()=>[e("span",ht,"R$ "+i(z(u.value.sPrice)),1)]),_:1}),s(p,{label:"开通状态"},{default:a(()=>[s(k,{color:u.value.sOpenStatus===1?"success":"default"},{default:a(()=>[n(i(u.value.sOpenStatus===1?"正常开通":"已关闭"),1)]),_:1},8,["color"])]),_:1}),s(p,{label:"审核状态"},{default:a(()=>[s(k,{color:V(u.value.sStatus)},{default:a(()=>[n(i(B(u.value.sStatus)),1)]),_:1},8,["color"])]),_:1}),s(p,{label:"开店时间",span:2},{default:a(()=>[n(i(u.value.createTime),1)]),_:1})]),_:1})):T("",!0),e("div",qt,[s(v,{onClick:t[5]||(t[5]=_=>m.value=!1)},{default:a(()=>[...t[31]||(t[31]=[n("关闭",-1)])]),_:1}),s(v,{onClick:t[6]||(t[6]=_=>j(u.value))},{default:a(()=>{var _;return[n(i(((_=u.value)==null?void 0:_.sOpenStatus)===1?"关闭店铺":"开通店铺"),1)]}),_:1}),((l=u.value)==null?void 0:l.sStatus)===1||((S=u.value)==null?void 0:S.sStatus)===2?(O(),D(v,{key:0,type:"primary",danger:"",onClick:t[7]||(t[7]=_=>R(u.value))},{default:a(()=>{var _;return[n(i(((_=u.value)==null?void 0:_.sStatus)===1?"冻结店铺":"解冻店铺"),1)]}),_:1})):T("",!0)])]}),_:1},8,["open"])])}}}),Pt=rt(At,[["__scopeId","data-v-11284ae9"]]);export{Pt as default};
