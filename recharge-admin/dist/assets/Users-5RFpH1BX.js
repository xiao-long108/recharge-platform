import{r as D}from"./request-npLowYHc.js";import{e,k as E,d as Ce,r as $,a as R,E as Pe,c as V,b as g,w as a,N as Ue,O as A,S as je,h as c,f as v,P as ze,I as De,Q as K,R as Me,T as Be,U as Re,B as Ve,V as Ee,W as Ie,p as j,X as ee,A as Ne,y as p,M as Te,s as Ae,Y as qe,Z as Fe,$ as He,a0 as Le,a1 as Ye,a2 as Qe,F as We,_ as Je,a3 as Xe,a4 as Ze,a5 as Ge,a6 as Ke,i as w,D as et,o as O,j as tt}from"./index-Djgp8zeB.js";import{U as at}from"./UserOutlined-xGvqhODp.js";import{W as te}from"./WalletOutlined-CNTM3-gi.js";import{L as nt}from"./LockOutlined-CL4E4fcf.js";var lt={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"};function ae(o){for(var n=1;n<arguments.length;n++){var l=arguments[n]!=null?Object(arguments[n]):{},r=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(l).filter(function(u){return Object.getOwnPropertyDescriptor(l,u).enumerable}))),r.forEach(function(u){ot(o,u,l[u])})}return o}function ot(o,n,l){return n in o?Object.defineProperty(o,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):o[n]=l,o}var q=function(n,l){var r=ae({},n,l.attrs);return e(E,ae({},r,{icon:lt}),null)};q.displayName="ExportOutlined";q.inheritAttrs=!1;var st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5l-41.1 41.1-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-44.9 44.9-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-65.3 65.3a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6A304.06 304.06 0 00608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644c-60.9 0-118.2-23.7-161.2-66.8-43.1-43-66.8-100.3-66.8-161.2 0-60.9 23.7-118.2 66.8-161.2 43-43.1 100.3-66.8 161.2-66.8 60.9 0 118.2 23.7 161.2 66.8 43.1 43 66.8 100.3 66.8 161.2 0 60.9-23.7 118.2-66.8 161.2z"}}]},name:"key",theme:"outlined"};function ne(o){for(var n=1;n<arguments.length;n++){var l=arguments[n]!=null?Object(arguments[n]):{},r=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(l).filter(function(u){return Object.getOwnPropertyDescriptor(l,u).enumerable}))),r.forEach(function(u){rt(o,u,l[u])})}return o}function rt(o,n,l){return n in o?Object.defineProperty(o,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):o[n]=l,o}var F=function(n,l){var r=ne({},n,l.attrs);return e(E,ne({},r,{icon:st}),null)};F.displayName="KeyOutlined";F.inheritAttrs=!1;var it={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"};function le(o){for(var n=1;n<arguments.length;n++){var l=arguments[n]!=null?Object(arguments[n]):{},r=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(l).filter(function(u){return Object.getOwnPropertyDescriptor(l,u).enumerable}))),r.forEach(function(u){ut(o,u,l[u])})}return o}function ut(o,n,l){return n in o?Object.defineProperty(o,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):o[n]=l,o}var H=function(n,l){var r=le({},n,l.attrs);return e(E,le({},r,{icon:it}),null)};H.displayName="MoreOutlined";H.inheritAttrs=!1;var ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464H332V240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v68c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-68c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zm-40 376H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"unlock",theme:"outlined"};function oe(o){for(var n=1;n<arguments.length;n++){var l=arguments[n]!=null?Object(arguments[n]):{},r=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(l).filter(function(u){return Object.getOwnPropertyDescriptor(l,u).enumerable}))),r.forEach(function(u){dt(o,u,l[u])})}return o}function dt(o,n,l){return n in o?Object.defineProperty(o,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):o[n]=l,o}var L=function(n,l){var r=oe({},n,l.attrs);return e(E,oe({},r,{icon:ct}),null)};L.displayName="UnlockOutlined";L.inheritAttrs=!1;const pt={class:"users-page"},ft={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4"},mt={key:0,class:"user-cell"},_t={class:"user-info"},vt={class:"user-name"},gt={class:"user-meta"},bt={key:2,class:"text-green-500 font-medium"},yt={key:3,class:"text-orange-500 font-medium"},Ot={class:"text-green-500 font-medium"},kt={class:"text-orange-500 font-medium"},xt={class:"mt-4 flex justify-end gap-2"},wt={class:"mt-4"},$t={class:"text-green-500 font-medium"},ht="https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",St=Ce({__name:"Users",setup(o){const n=$(!1),l=$([]),r=$([]),u=$(!1),f=$(null),k=R({totalUsers:0,todayUsers:0,totalBalance:0,totalCommission:0}),b=R({pageNum:1,pageSize:10,mobile:"",status:void 0}),h=R({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:i=>`共 ${i} 条记录`}),se=[{title:"用户信息",key:"userInfo",width:220,fixed:"left"},{title:"邀请码",key:"inviteCode",width:110,align:"center"},{title:"账户余额",key:"price",width:140,align:"right"},{title:"佣金余额",key:"incomePrice",width:140,align:"right"},{title:"团队人数",dataIndex:"teamCount",width:100,align:"center"},{title:"状态",key:"status",width:90,align:"center"},{title:"注册时间",dataIndex:"createTime",width:160,align:"center"},{title:"操作",key:"action",width:100,fixed:"right",align:"center"}],z=i=>i?i.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00",Y=async()=>{try{const i=await D.get("/api/admin/stats/users");i.data.code===200&&Object.assign(k,i.data.data)}catch{k.totalUsers=12580,k.todayUsers=156,k.totalBalance=8568e3,k.totalCommission=1256800}},P=async()=>{var i;n.value=!0;try{const t={...b};((i=r.value)==null?void 0:i.length)===2&&(t.startDate=r.value[0],t.endDate=r.value[1]);const _=await D.get("/api/admin/users",{params:t});_.data.code===200&&(l.value=_.data.data.records,h.total=_.data.data.total)}catch(t){console.error(t)}finally{n.value=!1}},re=()=>{b.mobile="",b.status=void 0,b.pageNum=1,r.value=[],h.current=1,P()},ie=i=>{h.current=i.current||1,h.pageSize=i.pageSize||10,b.pageNum=h.current,b.pageSize=h.pageSize,P()},ue=i=>{f.value=i,u.value=!0},ce=()=>{w.info("导出任务已创建，请稍后在下载中心查看")},M=$(!1),I=$(!1),U=$(null),m=R({type:"add",amount:0,remark:""}),Q=i=>{U.value=i,m.type="add",m.amount=0,m.remark="",M.value=!0,u.value=!1},de=async()=>{if(!m.amount||m.amount<=0){w.error("请输入有效金额");return}if(!m.remark){w.error("请填写调整原因");return}I.value=!0;try{await D.put(`/api/admin/users/${U.value.id}/balance`,m),w.success("调整成功"),M.value=!1,P(),Y()}catch{w.error("调整失败")}finally{I.value=!1}},W=i=>{const t=i.status===1?2:1,_=i.status===1?"冻结":"解冻";A.confirm({title:`确认${_}`,content:`确定要${_}该用户吗？${i.status===1?"冻结后用户将无法登录。":""}`,okText:"确定",cancelText:"取消",onOk:async()=>{try{await D.put(`/api/admin/users/${i.id}/status`,{status:t}),w.success(`${_}成功`),P()}catch{w.error(`${_}失败`)}}})},pe=i=>{A.confirm({title:"确认重置密码",content:"确定要重置该用户密码为 123456 吗？",okText:"确定",cancelText:"取消",okButtonProps:{danger:!0},onOk:async()=>{try{await D.put(`/api/admin/users/${i.id}/reset-password`),w.success("重置成功，新密码为 123456"),u.value=!1}catch{w.error("重置失败")}}})};return Pe(()=>{Y(),P()}),(i,t)=>{const _=je,S=Ue,fe=De,J=Be,me=Me,_e=Re,C=Ve,ve=ze,ge=Ne,N=Le,B=Ae,be=Fe,ye=Te,Oe=et,ke=Ie,y=He,X=Ye,Z=A,xe=Qe,G=Ze,we=Xe,T=Je,$e=Ge,he=Ke,Se=We;return O(),V("div",pt,[g("div",ft,[e(S,null,{default:a(()=>[e(_,{title:"总用户数",value:k.totalUsers,"value-style":{color:"#1890ff"}},{prefix:a(()=>[e(v(at))]),suffix:a(()=>[...t[11]||(t[11]=[c("人",-1)])]),_:1},8,["value"])]),_:1}),e(S,null,{default:a(()=>[e(_,{title:"今日新增",value:k.todayUsers,"value-style":{color:"#52c41a"}},{suffix:a(()=>[...t[12]||(t[12]=[c("人",-1)])]),_:1},8,["value"])]),_:1}),e(S,null,{default:a(()=>[e(_,{title:"用户总余额",value:k.totalBalance,precision:2,prefix:"R$","value-style":{color:"#52c41a"}},null,8,["value"])]),_:1}),e(S,null,{default:a(()=>[e(_,{title:"用户总佣金",value:k.totalCommission,precision:2,prefix:"R$","value-style":{color:"#fa8c16"}},null,8,["value"])]),_:1})]),e(S,{class:"mb-4"},{default:a(()=>[e(ve,{wrap:"",size:16},{default:a(()=>[e(fe,{value:b.mobile,"onUpdate:value":t[0]||(t[0]=s=>b.mobile=s),placeholder:"手机号/用户ID",style:{width:"180px"},"allow-clear":""},{prefix:a(()=>[e(v(K))]),_:1},8,["value"]),e(me,{value:b.status,"onUpdate:value":t[1]||(t[1]=s=>b.status=s),placeholder:"用户状态",style:{width:"120px"},"allow-clear":""},{default:a(()=>[e(J,{value:1},{default:a(()=>[...t[13]||(t[13]=[c("正常",-1)])]),_:1}),e(J,{value:2},{default:a(()=>[...t[14]||(t[14]=[c("冻结",-1)])]),_:1})]),_:1},8,["value"]),e(_e,{value:r.value,"onUpdate:value":t[2]||(t[2]=s=>r.value=s),placeholder:["注册开始","注册结束"],"value-format":"YYYY-MM-DD"},null,8,["value"]),e(C,{type:"primary",onClick:P},{default:a(()=>[e(v(K)),t[15]||(t[15]=c(" 查询 ",-1))]),_:1}),e(C,{onClick:re},{default:a(()=>[e(v(Ee)),t[16]||(t[16]=c(" 重置 ",-1))]),_:1}),e(C,{onClick:ce},{default:a(()=>[e(v(q)),t[17]||(t[17]=c(" 导出 ",-1))]),_:1})]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(ke,{columns:se,"data-source":l.value,loading:n.value,pagination:h,scroll:{x:1200},"row-key":"id",onChange:ie},{bodyCell:a(({column:s,record:d})=>[s.key==="userInfo"?(O(),V("div",mt,[e(ge,{size:40,src:d.avatar||ht},{default:a(()=>{var x;return[c(p(((x=d.nickname)==null?void 0:x.charAt(0))||"U"),1)]}),_:2},1032,["src"]),g("div",_t,[g("div",vt,p(d.nickname||"用户"+d.id),1),g("div",gt,"ID: "+p(d.id)+" | "+p(d.mobile),1)])])):s.key==="inviteCode"?(O(),j(N,{key:1},{default:a(()=>[c(p(d.inviteCode||"-"),1)]),_:2},1024)):s.key==="price"?(O(),V("span",bt,"R$ "+p(z(d.price)),1)):s.key==="incomePrice"?(O(),V("span",yt,"R$ "+p(z(d.incomePrice)),1)):s.key==="status"?(O(),j(N,{key:4,color:d.status===1?"success":"error"},{default:a(()=>[c(p(d.status===1?"正常":"冻结"),1)]),_:2},1032,["color"])):s.key==="action"?(O(),j(Oe,{key:5},{overlay:a(()=>[e(ye,null,{default:a(()=>[e(B,{onClick:x=>ue(d)},{default:a(()=>[e(v(qe)),t[19]||(t[19]=c(" 查看详情 ",-1))]),_:1},8,["onClick"]),e(B,{onClick:x=>Q(d)},{default:a(()=>[e(v(te)),t[20]||(t[20]=c(" 调整余额 ",-1))]),_:1},8,["onClick"]),e(be),d.status===1?(O(),j(B,{key:0,danger:"",onClick:x=>W(d)},{default:a(()=>[e(v(nt)),t[21]||(t[21]=c(" 冻结账号 ",-1))]),_:1},8,["onClick"])):(O(),j(B,{key:1,onClick:x=>W(d)},{default:a(()=>[e(v(L)),t[22]||(t[22]=c(" 解冻账号 ",-1))]),_:1},8,["onClick"]))]),_:2},1024)]),default:a(()=>[e(C,{type:"link",size:"small"},{default:a(()=>[t[18]||(t[18]=c(" 操作 ",-1)),e(v(H))]),_:1})]),_:2},1024)):ee("",!0)]),_:1},8,["data-source","loading","pagination"])]),_:1}),e(Z,{open:u.value,"onUpdate:open":t[6]||(t[6]=s=>u.value=s),title:"用户详情",width:"650px",footer:null},{default:a(()=>[f.value?(O(),j(X,{key:0,column:2,bordered:"",class:"mt-4"},{default:a(()=>[e(y,{label:"用户ID"},{default:a(()=>[c(p(f.value.id),1)]),_:1}),e(y,{label:"手机号"},{default:a(()=>[c(p(f.value.mobile),1)]),_:1}),e(y,{label:"昵称"},{default:a(()=>[c(p(f.value.nickname||"-"),1)]),_:1}),e(y,{label:"邀请码"},{default:a(()=>[c(p(f.value.inviteCode||"-"),1)]),_:1}),e(y,{label:"账户余额"},{default:a(()=>[g("span",Ot,"R$ "+p(z(f.value.price)),1)]),_:1}),e(y,{label:"佣金余额"},{default:a(()=>[g("span",kt,"R$ "+p(z(f.value.incomePrice)),1)]),_:1}),e(y,{label:"用户状态"},{default:a(()=>[e(N,{color:f.value.status===1?"success":"error"},{default:a(()=>[c(p(f.value.status===1?"正常":"冻结"),1)]),_:1},8,["color"])]),_:1}),e(y,{label:"注册时间"},{default:a(()=>[c(p(f.value.createTime),1)]),_:1})]),_:1})):ee("",!0),g("div",xt,[e(C,{onClick:t[3]||(t[3]=s=>u.value=!1)},{default:a(()=>[...t[23]||(t[23]=[c("关闭",-1)])]),_:1}),e(C,{type:"primary",onClick:t[4]||(t[4]=s=>Q(f.value))},{default:a(()=>[e(v(te)),t[24]||(t[24]=c(" 调整余额 ",-1))]),_:1}),e(C,{danger:"",onClick:t[5]||(t[5]=s=>pe(f.value))},{default:a(()=>[e(v(F)),t[25]||(t[25]=c(" 重置密码 ",-1))]),_:1})])]),_:1},8,["open"]),e(Z,{open:M.value,"onUpdate:open":t[10]||(t[10]=s=>M.value=s),title:"调整余额",width:"480px","confirm-loading":I.value,onOk:de},{default:a(()=>[g("div",wt,[e(X,{column:1,bordered:"",size:"small"},{default:a(()=>[e(y,{label:"用户"},{default:a(()=>{var s,d,x;return[c(p(((s=U.value)==null?void 0:s.nickname)||"用户"+((d=U.value)==null?void 0:d.id))+" ("+p((x=U.value)==null?void 0:x.mobile)+") ",1)]}),_:1}),e(y,{label:"当前余额"},{default:a(()=>{var s;return[g("span",$t,"R$ "+p(z((s=U.value)==null?void 0:s.price)),1)]}),_:1})]),_:1}),e(xe),e(Se,{layout:"vertical"},{default:a(()=>[e(T,{label:"操作类型",required:""},{default:a(()=>[e(we,{value:m.type,"onUpdate:value":t[7]||(t[7]=s=>m.type=s)},{default:a(()=>[e(G,{value:"add"},{default:a(()=>[...t[26]||(t[26]=[g("span",{class:"text-green-500"},"增加余额",-1)])]),_:1}),e(G,{value:"deduct"},{default:a(()=>[...t[27]||(t[27]=[g("span",{class:"text-red-500"},"扣除余额",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),e(T,{label:"金额",required:""},{default:a(()=>[e($e,{value:m.amount,"onUpdate:value":t[8]||(t[8]=s=>m.amount=s),min:0,precision:2,placeholder:"请输入金额",style:{width:"100%"}},{prefix:a(()=>[...t[28]||(t[28]=[c("R$",-1)])]),_:1},8,["value"])]),_:1}),e(T,{label:"备注",required:""},{default:a(()=>[e(he,{value:m.remark,"onUpdate:value":t[9]||(t[9]=s=>m.remark=s),rows:3,placeholder:"请输入调整原因（必填）"},null,8,["value"])]),_:1})]),_:1})])]),_:1},8,["open","confirm-loading"])])}}}),Dt=tt(St,[["__scopeId","data-v-4ee35fbd"]]);export{Dt as default};
