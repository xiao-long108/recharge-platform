import{r as x}from"./request-npLowYHc.js";import{e,k as W,d as Y,r as b,a as R,E as Z,c as C,b as i,X as B,w as l,R as K,B as tt,ae as et,ak as lt,f as y,al as at,O as j,T as nt,h as o,Q as st,V as ot,a9 as rt,F as it,p as ut,_ as dt,I as pt,a5 as ct,am as ft,y as k,i as U,o as O,ab as mt,ad as vt,a0 as _t,j as gt}from"./index-Djgp8zeB.js";var bt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2zM304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z"}}]},name:"picture",theme:"outlined"};function q(f){for(var r=1;r<arguments.length;r++){var u=arguments[r]!=null?Object(arguments[r]):{},d=Object.keys(u);typeof Object.getOwnPropertySymbols=="function"&&(d=d.concat(Object.getOwnPropertySymbols(u).filter(function(p){return Object.getOwnPropertyDescriptor(u,p).enumerable}))),d.forEach(function(p){yt(f,p,u[p])})}return f}function yt(f,r,u){return r in f?Object.defineProperty(f,r,{value:u,enumerable:!0,configurable:!0,writable:!0}):f[r]=u,f}var V=function(r,u){var d=q({},r,u.attrs);return e(W,q({},d,{icon:bt}),null)};V.displayName="PictureOutlined";V.inheritAttrs=!1;const kt={class:"banners-page"},Ut={class:"filter-bar"},Ot={class:"filter-left"},xt={class:"filter-right"},Ct={class:"banner-grid"},wt={class:"banner-image"},Pt=["src","alt"],zt={class:"banner-overlay"},Bt={class:"banner-info"},Vt={class:"banner-title"},Lt={class:"banner-meta"},St={class:"sort"},$t={key:0,class:"empty-state"},Et={key:0,class:"loading-state"},Rt=["src"],jt=Y({__name:"Banners",setup(f){const r=b(!1),u=b([]),d=b(!1),p=b(!1),L=b(),w=b(null),v=R({position:null,status:null}),n=R({title:"",imageUrl:"",linkUrl:"",position:1,sort:0,status:!0}),I={title:[{required:!0,message:"请输入标题",trigger:"blur"}],imageUrl:[{required:!0,message:"请输入图片地址",trigger:"blur"}],position:[{required:!0,message:"请选择展示位置",trigger:"change"}]},N=s=>({1:"首页轮播",2:"店铺轮播",3:"活动页"})[s]||"未知",T=s=>({1:"blue",2:"green",3:"orange"})[s]||"default",g=async()=>{r.value=!0;try{const s=await x.get("/api/admin/banners",{params:v});s.data.code===200&&(u.value=s.data.data)}catch(s){console.error(s)}finally{r.value=!1}},D=()=>{v.position=null,v.status=null,g()},S=()=>{p.value=!1,w.value=null,n.title="",n.imageUrl="",n.linkUrl="",n.position=1,n.sort=0,n.status=!0,d.value=!0},F=s=>{p.value=!0,w.value=s.id,n.title=s.title,n.imageUrl=s.imageUrl,n.linkUrl=s.linkUrl||"",n.position=s.position,n.sort=s.sort,n.status=s.status===1,d.value=!0},M=async()=>{await L.value.validate();try{const s={...n,status:n.status?1:0};p.value?await x.put(`/api/admin/banners/${w.value}`,s):await x.post("/api/admin/banners",s),U.success(p.value?"修改成功":"添加成功"),d.value=!1,g()}catch{U.error("操作失败")}},A=async s=>{try{await x.put(`/api/admin/banners/${s.id}/toggle`),U.success("操作成功"),g()}catch{U.error("操作失败")}},H=s=>{j.confirm({title:"提示",content:"确定要删除该轮播图吗？",onOk:async()=>{try{await x.delete(`/api/admin/banners/${s.id}`),U.success("删除成功"),g()}catch{U.error("删除失败")}}})};return Z(()=>{g()}),(s,t)=>{const c=nt,P=K,m=tt,$=_t,Q=at,z=pt,_=dt,X=ct,h=ft,G=it,J=j;return O(),C("div",kt,[i("div",Ut,[i("div",Ot,[e(P,{value:v.position,"onUpdate:value":t[0]||(t[0]=a=>v.position=a),placeholder:"展示位置","allow-clear":"",style:{width:"150px"}},{default:l(()=>[e(c,{value:null},{default:l(()=>[...t[10]||(t[10]=[o("全部位置",-1)])]),_:1}),e(c,{value:1},{default:l(()=>[...t[11]||(t[11]=[o("首页轮播",-1)])]),_:1}),e(c,{value:2},{default:l(()=>[...t[12]||(t[12]=[o("店铺轮播",-1)])]),_:1}),e(c,{value:3},{default:l(()=>[...t[13]||(t[13]=[o("活动页",-1)])]),_:1})]),_:1},8,["value"]),e(P,{value:v.status,"onUpdate:value":t[1]||(t[1]=a=>v.status=a),placeholder:"状态","allow-clear":"",style:{width:"120px"}},{default:l(()=>[e(c,{value:null},{default:l(()=>[...t[14]||(t[14]=[o("全部",-1)])]),_:1}),e(c,{value:1},{default:l(()=>[...t[15]||(t[15]=[o("启用",-1)])]),_:1}),e(c,{value:0},{default:l(()=>[...t[16]||(t[16]=[o("禁用",-1)])]),_:1})]),_:1},8,["value"])]),i("div",xt,[e(m,{type:"primary",onClick:g},{icon:l(()=>[e(y(st))]),default:l(()=>[t[17]||(t[17]=o(" 查询 ",-1))]),_:1}),e(m,{onClick:D},{icon:l(()=>[e(y(ot))]),default:l(()=>[t[18]||(t[18]=o(" 重置 ",-1))]),_:1}),e(m,{type:"primary",onClick:S},{icon:l(()=>[e(y(rt))]),default:l(()=>[t[19]||(t[19]=o(" 添加轮播图 ",-1))]),_:1})])]),i("div",Ct,[(O(!0),C(et,null,lt(u.value,a=>(O(),C("div",{key:a.id,class:"banner-card"},[i("div",wt,[i("img",{src:a.imageUrl,alt:a.title},null,8,Pt),i("div",zt,[e(m,{type:"primary",size:"small",onClick:E=>F(a)},{default:l(()=>[e(y(mt)),t[20]||(t[20]=o(" 编辑 ",-1))]),_:1},8,["onClick"]),e(m,{size:"small",onClick:E=>A(a)},{default:l(()=>[o(k(a.status===1?"禁用":"启用"),1)]),_:2},1032,["onClick"]),e(m,{danger:"",size:"small",onClick:E=>H(a)},{default:l(()=>[e(y(vt))]),_:1},8,["onClick"])])]),i("div",Bt,[i("div",Vt,k(a.title),1),i("div",Lt,[e($,{color:T(a.position)},{default:l(()=>[o(k(N(a.position)),1)]),_:2},1032,["color"]),e($,{color:a.status===1?"success":"default"},{default:l(()=>[o(k(a.status===1?"启用":"禁用"),1)]),_:2},1032,["color"]),i("span",St,"排序: "+k(a.sort),1)])])]))),128)),u.value.length===0&&!r.value?(O(),C("div",$t,[e(y(V),{class:"empty-icon"}),t[22]||(t[22]=i("p",null,"暂无轮播图",-1)),e(m,{type:"primary",onClick:S},{default:l(()=>[...t[21]||(t[21]=[o("添加轮播图",-1)])]),_:1})])):B("",!0)]),r.value?(O(),C("div",Et,[e(Q,{size:"large"})])):B("",!0),e(J,{open:d.value,"onUpdate:open":t[9]||(t[9]=a=>d.value=a),title:p.value?"编辑轮播图":"添加轮播图",width:"550px"},{footer:l(()=>[e(m,{onClick:t[8]||(t[8]=a=>d.value=!1)},{default:l(()=>[...t[28]||(t[28]=[o("取消",-1)])]),_:1}),e(m,{type:"primary",onClick:M},{default:l(()=>[o(k(p.value?"保存":"添加"),1)]),_:1})]),default:l(()=>[e(G,{model:n,rules:I,ref_key:"formRef",ref:L,"label-col":{span:5},"wrapper-col":{span:18},class:"mt-4"},{default:l(()=>[e(_,{label:"标题",name:"title"},{default:l(()=>[e(z,{value:n.title,"onUpdate:value":t[2]||(t[2]=a=>n.title=a),placeholder:"轮播图标题",maxlength:50},null,8,["value"])]),_:1}),e(_,{label:"图片地址",name:"imageUrl"},{default:l(()=>[e(z,{value:n.imageUrl,"onUpdate:value":t[3]||(t[3]=a=>n.imageUrl=a),placeholder:"请输入图片URL"},null,8,["value"]),t[23]||(t[23]=i("div",{class:"mt-2 text-xs text-gray-400"},"建议尺寸: 750 x 300 像素",-1))]),_:1}),n.imageUrl?(O(),ut(_,{key:0,label:"预览"},{default:l(()=>[i("img",{src:n.imageUrl,class:"preview-image"},null,8,Rt)]),_:1})):B("",!0),e(_,{label:"跳转链接"},{default:l(()=>[e(z,{value:n.linkUrl,"onUpdate:value":t[4]||(t[4]=a=>n.linkUrl=a),placeholder:"点击后跳转的URL（选填）"},null,8,["value"])]),_:1}),e(_,{label:"展示位置",name:"position"},{default:l(()=>[e(P,{value:n.position,"onUpdate:value":t[5]||(t[5]=a=>n.position=a),placeholder:"请选择"},{default:l(()=>[e(c,{value:1},{default:l(()=>[...t[24]||(t[24]=[o("首页轮播",-1)])]),_:1}),e(c,{value:2},{default:l(()=>[...t[25]||(t[25]=[o("店铺轮播",-1)])]),_:1}),e(c,{value:3},{default:l(()=>[...t[26]||(t[26]=[o("活动页",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),e(_,{label:"排序"},{default:l(()=>[e(X,{value:n.sort,"onUpdate:value":t[6]||(t[6]=a=>n.sort=a),min:0,max:999,style:{width:"120px"}},null,8,["value"]),t[27]||(t[27]=i("span",{class:"ml-2 text-gray-400"},"数字越小越靠前",-1))]),_:1}),e(_,{label:"状态"},{default:l(()=>[e(h,{checked:n.status,"onUpdate:checked":t[7]||(t[7]=a=>n.status=a),"checked-children":"启用","un-checked-children":"禁用"},null,8,["checked"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),Nt=gt(jt,[["__scopeId","data-v-ec6332c6"]]);export{Nt as default};
